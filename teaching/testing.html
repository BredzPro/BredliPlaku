<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MTH 202 Course Notes</title>
	<link rel="icon" type="image/png" href="https://bredliplaku.github.io/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
<style>
    :root {
        --primary-color: #3949ab;
        --primary-dark: #1a237e;
        --secondary-color: #ffa726;
        --background-color: #f4f4f4;
        --card-background: #ffffff;
        --text-color: #333333;
        --text-light: #ffffff;
    }
    body, html {
        margin: 0;
        padding: 0;
        font-family: 'Roboto', sans-serif;
        background: #ffffff;
        color: #333;
    }
    .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
    }
    .course-header {
        background: linear-gradient(135deg, #3949ab, #1a237e);
        color: white;
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
		-webkit-user-select: none;
		-khtml-user-select: none;
    }
    h1 {
        margin: 0 0 10px 0;
        font-weight: 700;
        font-size: 2.0em;
    }
    h2 {
        margin: 0 0 2px 0;
        font-weight: 400;
        font-size: 1.0em;
    }
    .course-info {
        display: flex;
        justify-content: left;
        flex-wrap: wrap;
        margin-top: 15px;
        margin-bottom: 5px;
        gap: 10px;
    }
    .info-item {
        background-color: rgba(255,255,255,0.1);
        padding: 10px 15px;
        border-radius: 10px;
        font-size: 0.9em;
    }
    .week-counter {
        padding: 10px 0px;
        border-radius: 10px;
        margin: 5px;
        font-size: 0.9em;
        display: inline-block;
    }
    .progress-bar {
        background-color: rgb(251, 251, 251);
        height: 10px;
        border-radius: 5px;
        margin: 5px;
        overflow: hidden;
    }
    .progress {
        width: 60%;
        height: 100%;
        background-color: #4caf50;
        transition: width 0.5s ease-in-out;
    }
    .module {
        background-color: #fff;
        border-radius: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .module:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .module-header {
        background-color: #3949ab;
        color: white;
        padding: 15px;
        font-weight: 500;
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
		-webkit-user-select: none;
		-khtml-user-select: none;
		flex-wrap: wrap; /* Allow items to wrap on smaller screens */
		position: relative;
    }
    .module-title {
        font-size: 1.1em;
    }
	.module-chapter {
		margin-left: auto;
		font-size: 0.9em; 
		font-weight: 800;
		display: flex; 
		align-items: center;
		text-transform: uppercase;
	}
    .module-content {
        padding: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out, padding 0.3s ease-out;
    }
    .module.active .module-content {
        padding: 15px;
        max-height: 2500px;
        transition: max-height 0.5s ease-in, padding 0.3s ease-in;
    }
    .material-item {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        padding: 5px 15px;
        border-bottom: 1px solid #e0e0e0;
		margin-top: 5px;
    }
    .material-item:last-child {
        border-bottom: none;
    }
    .material-icon {
        font-size: 1.5em;
        margin-right: 15px;
        color: #3949ab;
    }
    .material-info {
        flex-grow: 1;
        margin-bottom: 10px;
    }
    .material-title {
        font-weight: 500;
        margin-bottom: 5px;
    }
    .material-description {
        font-size: 0.9em;
        color: #666;
		-webkit-user-select: none;
		-khtml-user-select: none;
    }
    button {
        display: inline-block;
        background-color: var(--primary-color);
        color: var(--text-light);
        padding: 10px 20px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 0.9em;
        transition: background-color 0.3s, transform 0.3s;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
		border: 0;
		-webkit-user-select: none;
		-khtml-user-select: none;
    }
    button:hover {
        background-color: #1a237e;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transform: translateY(-2px);
		cursor: pointer;
    }
    button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }
    .btn-green { background-color: #43a047; }
    .btn-green:hover { background-color: #2e7d32; }
    .btn-orange { background-color: #fb8c00; }
    .btn-orange:hover { background-color: #ef6c00; }
    .btn-blue { background-color: #2196F3; }
    .btn-blue:hover { background-color: #1e87db; }
	.btn-purple { background-color: #9c27b0; }
	.btn-purple:hover { background-color: #7b1fa2; }
    .btn-red { background-color: #f44336; }
    .btn-red:hover { background-color: #d32f2f; }
	
    .fun-fact {
        background-color: #FFF9C4;
        border-left: 5px solid #FBC02D;
        padding: 15px;
        margin-top: 20px;
        border-radius: 5px;
        font-style: italic;
    }
    .course-schedule {
		display: flex
		margin-top: 15px;
        margin-bottom: 15px;
    }
    .course-schedule h2 {
        color: #3949ab;
        margin-top: 0;
        margin-bottom: 15px;
    }
    .schedule-container {
        display: flex;
        flex-direction: row;
        gap: 15px;
    }
    .schedule-item {
        width: 100%;
        margin-bottom: 5px;
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 6px 12px rgba(0,0,0,0.10);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .schedule-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .schedule-item .day {
        padding: 10px;
        color: white;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .schedule-item .time-location {
        flex-grow: 1;
        padding: 10px;
        background-color: white;
    }
    .schedule-item .time {
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .schedule-item .location {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .schedule-item.lecture .day {
        background-color: #3949ab;
    }
    .schedule-item.lab .day {
        background-color: #1e87db;
    }
    .course-actions {
        padding: 5px;
        display: flex;
        justify-content: flex-start;
        flex-wrap: wrap;
        gap: 10px;
    }
    .footer {
        max-width: 1000px;
        text-align: center;
        padding: 20px 0;
        color: var(--primary-dark);
        border-radius: 20px;
        margin-left: auto;
        margin-right: auto;
		-webkit-user-select: none;
		-khtml-user-select: none;
    }
    .social-links {
        margin-bottom: 10px;
        margin-top: 10px;
    }
    .social-links a {
        color: var(--primary-dark);
        font-size: 1.0em;
        margin: 0 10px;
        transition: color 0.3s;
    }
    .social-links a:hover {
        color: var(--secondary-color);
    }

	.iframe-container {
		width: 100%;
		height: 0;
		overflow: hidden;
		opacity: 0;
		transition: opacity 0.5s ease-out, height 0.5s ease-out;
		position: relative;
		pointer-events: none;
	}

	.iframe-container.visible {
		height: 310px;
		opacity: 1;
		pointer-events: auto;
	}

    iframe {
        width: 106.4%;
        height: 1440px; /* Large enough to contain the content */
        border: none;
        position: absolute;
        top: -335px; /* Adjust this to shift the visible part of the page */
        left: -64px;
    }
	.iframe-container:not(.visible) {
		height: 0 !important;
	}
.grade-distribution-container {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease-out;
}
.grade-distribution-content {
    padding: 5px;
}
.distribution-wrapper {
    margin-top: 15px;
    position: relative;
}

.distribution-bar {
    height: 15px;
    border-radius: 50px;
    overflow: hidden;
    display: flex;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    position: relative;
}
.distribution-segment {
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: scale(1);
    transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1), width 1s ease;
}

.distribution-segment:hover {
    transform: scale(1.05);
    transition: transform 0.3s ease-in-out; /* Smooth hover effect */
}


.segment-percentage {
    color: #ffffff;
    font-weight: 700;
    font-size: 0.8em;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
	padding-left: 5px;
    padding-right: 5px;
    z-index: 1; /* Ensure it stays on top */
}
.distribution-legend {
    display: flex;
    justify-content: space-between;
    margin-top: 5px; /* Add some margin to separate the bar from the legend */
}

.legend-item {
    width: auto; /* Adjust to take only the needed space */
    text-align: center;
    font-size: 0.8em;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 2px;
    white-space: nowrap; /* Prevents text from wrapping */
}

/* Absence form styles */
.absence-container {
    width: 100%;
    height: 0;
    overflow: hidden;
    opacity: 0;
    transition: opacity 0.5s ease-out, height 0.5s ease-out;
    margin-bottom: 20px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
}

.absence-container.visible {
    height: auto;
    opacity: 1;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.absence-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.absence-header h2 {
    margin: 0;
    font-weight: 600;
    font-size: 1.4em;
}

.absence-content {
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
}

.form-group input[type="text"],
.form-group input[type="email"],
.form-group input[type="date"],
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 10px;
    font-family: inherit;
    font-size: 1em;
    box-sizing: border-box;
}

.form-group input.error,
.form-group select.error,
.form-group textarea.error {
    border-color: #f44336;
    background-color: #ffebee;
}

.form-group input[readonly] {
    background-color: #f5f5f5;
    color: #666;
    cursor: not-allowed;
}

.form-group small {
    display: block;
    color: #666;
    margin-top: 5px;
    font-size: 0.85em;
}

.form-group.checkbox-group {
    display: flex;
    align-items: flex-start;
}

.form-group.checkbox-group input[type="checkbox"] {
    margin-top: 5px;
    margin-right: 10px;
}

.form-group.checkbox-group label {
    font-weight: normal;
    line-height: 1.5;
}

.required {
    color: #f44336;
}

.error-message {
    color: #f44336;
    font-size: 0.85em;
    margin-top: 5px;
    font-weight: 500;
    display: none;
}

.form-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
}

.email-field-container {
    display: flex;
    align-items: center;
}

.email-prefix, .email-suffix {
    background-color: #f5f5f5;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 10px 0 0 10px;
    color: #666;
}

.email-suffix {
    border-radius: 0 10px 10px 0;
    border-left: none;
}

.email-number {
    border-radius: 0;
    width: 60px !important;
    text-align: center;
    border-left: none;
    border-right: none;
}

.notice-box {
    background-color: #e8f4f8;
    border-left: 5px solid #2196F3;
    padding: 15px;
    margin-top: 20px;
    margin-bottom: 20px;
    border-radius: 5px;
}

.disclaimer {
    margin-top: 20px;
    font-size: 0.9em;
    color: #757575;
    font-style: italic;
}

/* Modal styles */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    overflow-y: auto;
}

.modal-content {
    background-color: var(--card-background);
    margin: 5% auto;
    max-width: 600px;
    border-radius: 20px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    animation: modalFadeIn 0.3s;
    max-height: 90vh;
    overflow-y: auto;
}

@keyframes modalFadeIn {
    from {opacity: 0; transform: translateY(-30px);}
    to {opacity: 1; transform: translateY(0);}
}

.modal-header {
    background: linear-gradient(135deg, #f44336, #d32f2f);
    color: white;
    padding: 15px 20px;
    border-radius: 20px 20px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 10;
}

.modal-header h2 {
    margin: 0;
    font-size: 1.5em;
    font-weight: 500;
}

.close, .close-confirmation {
    color: white;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal-body {
    padding: 20px;
}

    /* FOR TIMETABLE */
    @media (max-width: 1000px) {
		.iframe-container.visible {
			height: 310px; /* Set the height you want to show */
		}
        iframe {
            top: -395px; /* Shift the iframe content for smaller views */
            left: -58px;
        }

    }
	@media (max-width: 500px) {
	.module-header {
	flex-direction: column; /* Stack items vertically on smaller screens */
	align-items: flex-start; /* Align text to the left */
    }
    .module-title {
        margin-bottom: 8px; /* Add space between wrapped items */
        text-align: left; /* Make sure text aligns properly */
    }
	}
	
	@media (max-width: 768px) {
	.iframe-container.visible {
		height: 260px; /* Set the height you want to show */
		padding-left: 5%;
	}
	iframe {
		top: -460px; /* Shift the iframe content for smaller screens */
		left: -53px;
	}

    .segment-percentage {
        font-size: 0.45em; /* Decrease size further for mobile */
    }

    .legend-item {
        font-size: 0.5em; /* Ensure the legend scales down too */
		font-weight: 500;
		letter-spacing: -0.5px;
		margin-bottom: 0px;
    }
	.btn-download {
		display:none;
	}
    
    .form-buttons {
        flex-direction: column;
        gap: 10px;
    }
    
    .form-buttons button {
        width: 100%;
    }
    
    .modal-content {
        width: 95%;
        margin: 10% auto;
        max-height: 80vh;
    }
    
    .email-field-container {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .email-prefix, .email-suffix, .email-number {
        width: 100% !important;
        border-radius: 10px;
        border: 1px solid #ddd;
        margin-bottom: 5px;
    }
    }
</style>

    <script>
		
		function toggleModule(element) {
            element.classList.toggle('active');
        }

        function calculateWeek(startDate, endDate, holidayWeeks = 0) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            const today = new Date();
            const totalWeeks = Math.ceil((end - start) / (7 * 24 * 60 * 60 * 1000));
            const currentWeek = Math.ceil((today - start) / (7 * 24 * 60 * 60 * 1000));
			const adjustedWeek = currentWeek - holidayWeeks;
            return Math.min(Math.max(adjustedWeek, 1), totalWeeks);
        }

        function updateWeekCounter() {
            const startDate = "2025-02-24"; // Replace with your course start date
            const endDate = "2025-06-14";   // Replace with your course end date
			const holidayWeeks = 0; // Subtract weeks for holidays
            const weekCounter = document.getElementById('week-counter');
            const currentWeek = calculateWeek(startDate, endDate, holidayWeeks);
            weekCounter.textContent = `Week ${currentWeek}`;
        }

        function updateProgress() {
            const startDate = new Date("2025-02-24"); // Replace with your course start date
            const endDate = new Date("2025-06-14");   // Replace with your course end date
            const today = new Date();
            const totalDuration = endDate - startDate;
            const elapsedDuration = today - startDate;
            let progressPercentage = (elapsedDuration / totalDuration) * 100;
            progressPercentage = Math.min(Math.max(progressPercentage, 0), 100);

            const progress = document.querySelector('.progress');
            progress.style.width = progressPercentage + '%';
        }

		function updateYear() {
			const yearElement = document.getElementById('currentYear');
			if (yearElement) {
				yearElement.textContent = new Date().getFullYear();
			}
		}
		
		function toggleIframe() {
			var iframeContainer = document.getElementById("iframe-container");
			var button = document.getElementById("toggle-button");

			if (iframeContainer.classList.contains('visible')) {
				iframeContainer.classList.remove('visible');
				button.innerHTML = '<i class="fas fa-calendar-alt"></i> Timetable';
				setTimeout(() => {
					iframeContainer.style.display = 'none';
				}, 500); // Match this to the transition duration
			} else {
				iframeContainer.style.display = 'block';
				// Force a reflow before adding the 'visible' class
				iframeContainer.offsetHeight;
				iframeContainer.classList.add('visible');
				button.innerHTML = '<i class="fa fa-eye-slash"></i> Hide Timetable';
			}
		}
		
const courseAssessments = [
	{ name: 'Attendance', subItems: [
        { name: 'Attendance 1', percentage: 10 }
    ]},
	{ name: 'Homework', subItems: [
        { name: 'Homework 1', percentage: 0 },
        { name: 'Homework 2', percentage: 0 },
        { name: 'Homework 3', percentage: 0 },
        { name: 'Homework 4', percentage: 0 }
    ]},
    { name: 'Quizzes', subItems: [
        { name: 'Quiz 1', percentage: 10 },
        { name: 'Quiz 2', percentage: 10 },
        { name: 'Quiz 3', percentage: 0 },
        { name: 'Quiz 4', percentage: 0 }
    ]},
    { name: 'Midterm', subItems: [{ name: 'Midterm', percentage: 35 }] },
    { name: 'Final', subItems: [{ name: 'Final', percentage: 35 }] }
];

const colorSchemes = {
    'Homework': ['#81c784', '#66bb6a', '#4caf50', '#43a047'],
    'Quizzes': ['#64b5f6', '#42a5f5', '#2196f3', '#1e88e5'],
    'Attendance': ['#4caf50'],
    'Midterm': ['#fbc02d'],
    'Final': ['#ff9800']
};

function toggleGradeDistribution() {
    const container = document.getElementById('gradeDistributionContainer');
    const button = document.getElementById('gradeDistributionButton');
    
    if (container.style.maxHeight) {
        container.style.maxHeight = null;
        button.innerHTML = '<i class="fas fa-chart-pie"></i> Evaluation Criteria';
    } else {
        generateGradeDistribution();
        container.style.maxHeight = container.scrollHeight + "px";
        button.innerHTML = '<i class="fa fa-eye-slash"></i> Hide Evaluation Criteria';
    }
}

function generateGradeDistribution() {
    const barContainer = document.getElementById('distribution-bar');
    const legendContainer = document.getElementById('distribution-legend');
    
    barContainer.innerHTML = '';
    legendContainer.innerHTML = '';
    
    let cumulativeWidth = 0;
    
    courseAssessments.forEach((assessment) => {
        const colors = colorSchemes[assessment.name];
        let totalPercentage = 0;
        let colorIndex = 0;
        
        assessment.subItems.forEach((subItem, index) => {
            if (subItem.percentage > 0) {
                const color = colors[colorIndex % colors.length];
                
                // Create bar segment
                const segment = document.createElement('div');
                segment.className = 'distribution-segment';
                segment.style.width = `${subItem.percentage}%`;
                segment.style.backgroundColor = color;
                
                // Add percentage inside the bar
                const percentageElement = document.createElement('div');
                percentageElement.className = 'segment-percentage';
                percentageElement.textContent = `${subItem.percentage}%`;
                segment.appendChild(percentageElement);
                
                barContainer.appendChild(segment);
                
                totalPercentage += subItem.percentage;
                colorIndex++;
            }
        });
        
        if (totalPercentage > 0) {
            // Create legend item (name below the segments)
            const legendItem = document.createElement('div');
            legendItem.className = 'legend-item';
            legendItem.style.left = `${cumulativeWidth}%`;
            legendItem.style.width = `${totalPercentage}%`;
            legendItem.textContent = assessment.name;
            
            // Set the text color to match the first color in the assessment's color scheme
            legendItem.style.color = colors[0];
            
            legendContainer.appendChild(legendItem);
            
            cumulativeWidth += totalPercentage;
        }
    });
}

// Absence form functions
function toggleAbsenceForm() {
    var absenceContainer = document.getElementById("absence-container");
    var button = document.getElementById("absenceButton");

    if (absenceContainer.classList.contains('visible')) {
        absenceContainer.classList.remove('visible');
        button.innerHTML = '<i class="fas fa-user-clock"></i> Report Absence';
    } else {
        absenceContainer.classList.add('visible');
        button.innerHTML = '<i class="fa fa-eye-slash"></i> Hide Form';
    }
}

// Generate a reference ID
function generateReferenceID() {
    const date = new Date();
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
    return `ABS-${year}${month}${day}-${random}`;
}

// Validate date for absence form
function validateDate() {
    const dateField = document.getElementById('absenceDate');
    const dateError = document.getElementById('dateError');
    
    const selectedDate = new Date(dateField.value + 'T00:00:00');
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    const twoDaysAgo = new Date(today);
    twoDaysAgo.setDate(today.getDate() - 2);
    
    const oneWeekLater = new Date(today);
    oneWeekLater.setDate(today.getDate() + 7);
    
    if (selectedDate < twoDaysAgo) {
        dateError.textContent = "You are reporting too late";
        dateError.style.display = 'block';
        dateField.classList.add('error');
        return false;
    } else if (selectedDate > oneWeekLater) {
        dateError.textContent = "The date is too far in the future";
        dateError.style.display = 'block';
        dateField.classList.add('error');
        return false;
    } else {
        dateError.style.display = 'none';
        dateField.classList.remove('error');
        return true;
    }
}

// Update form based on selected reason
function updateAbsenceReason() {
    const reasonField = document.getElementById('absenceReason');
    const explanationField = document.getElementById('absenceExplanation');
    const documentGroup = document.getElementById('documentGroup');
    const docRequired = document.getElementById('docRequired');
    const documentField = document.getElementById('absenceDocument');
    const attachmentDescription = document.getElementById('attachmentDescription');
    const minChars = document.getElementById('minChars');
    
    // Configure form based on reason
    switch(reasonField.value) {
        case 'Illness':
            // Show attachment field and make it required
            documentGroup.style.display = 'block';
            docRequired.style.display = 'inline';
            documentField.required = true;
            attachmentDescription.textContent = "Please upload a medical report or doctor's note (PDF, JPG, PNG, max 5MB)";
            
            // Set standard explanation length
            minChars.textContent = '50';
            explanationField.setAttribute('minlength', '50');
            break;
            
        case 'Transport':
            // Hide attachment field
            documentGroup.style.display = 'none';
            documentField.required = false;
            
            // Increase explanation length
            minChars.textContent = '100';
            explanationField.setAttribute('minlength', '100');
            break;
            
        case 'Other':
            // Show attachment field as optional
            documentGroup.style.display = 'block';
            docRequired.style.display = 'none';
            documentField.required = false;
            attachmentDescription.textContent = "Supporting documentation (optional, PDF, JPG, PNG, max 5MB)";
            
            // Increase explanation length
            minChars.textContent = '100';
            explanationField.setAttribute('minlength', '100');
            break;
        default:
            // Default case
            documentGroup.style.display = 'none';
            documentField.required = false;
            minChars.textContent = '50';
            explanationField.setAttribute('minlength', '50');
    }
    
    // Update validation
    validateForm();
}

// Update character count
function updateCharCount() {
    const explanationField = document.getElementById('absenceExplanation');
    const charCount = document.getElementById('charCount');
    const explanationError = document.getElementById('explanationError');
    const minLength = parseInt(explanationField.getAttribute('minlength'));
    const currentLength = explanationField.value.length;
    
    charCount.textContent = currentLength;
    
    if (currentLength < minLength) {
        charCount.style.color = '#f44336';
        explanationError.style.display = 'block';
        explanationField.classList.add('error');
    } else {
        charCount.style.color = '#4caf50';
        explanationError.style.display = 'none';
        explanationField.classList.remove('error');
    }
}

// Validate entire form
function validateForm() {
    const form = document.getElementById('absenceForm');
    const nameField = document.getElementById('studentName');
    const idField = document.getElementById('studentID');
    const emailNumberField = document.getElementById('emailNumber');
    const reasonField = document.getElementById('absenceReason');
    const explanationField = document.getElementById('absenceExplanation');
    const documentField = document.getElementById('absenceDocument');
    const honorCodeField = document.getElementById('honorCode');
    const submitBtn = document.getElementById('submitBtn');
    
    const nameValid = nameField.value.trim() !== '';
    const idValid = idField.value.match(/^[0-9]+$/);
    const emailValid = emailNumberField.value.match(/^[0-9]{2}$/);
    const dateValid = validateDate();
    const reasonValid = reasonField.value !== '' && reasonField.value !== null;
    
    // Explanation validation
    const minLength = parseInt(explanationField.getAttribute('minlength') || '50');
    const explanationValid = explanationField.value.length >= minLength;
    
    // Document validation (required only for illness)
    const documentValid = reasonField.value !== 'Illness' || documentField.files.length > 0;
    
    // Honor code validation
    const honorValid = honorCodeField.checked;
    
    // Enable submit button only if all validations pass
    submitBtn.disabled = !(nameValid && idValid && emailValid && dateValid && 
                        reasonValid && explanationValid && documentValid && honorValid);
}

// Get full email from form
function getFullEmail() {
    const firstName = document.getElementById('firstName').value.toLowerCase();
    const lastName = document.getElementById('lastName').value.toLowerCase();
    const emailNumber = document.getElementById('emailNumber').value;
    
    return `${firstName}${lastName}${emailNumber}@epoka.edu.al`;
}

// Submit the form to email
function submitForm() {
    const form = document.getElementById('absenceForm');
    
    // Final validation
    validateForm();
    
    if (document.getElementById('submitBtn').disabled) {
        return false;
    }
    
    const name = document.getElementById('studentName').value;
    const id = document.getElementById('studentID').value;
    const firstName = document.getElementById('firstName').value;
    const lastName = document.getElementById('lastName').value;
    const emailNumber = document.getElementById('emailNumber').value;
    const fullEmail = `${firstName}${lastName}${emailNumber}@epoka.edu.al`;
    const date = document.getElementById('absenceDate').value;
    const reason = document.getElementById('absenceReason').value;
    const explanation = document.getElementById('absenceExplanation').value;
    const referenceID = generateReferenceID();
    
    // Format date for email subject
    const formattedDate = new Date(date).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
    });
    
    // Create email subject
    const emailSubject = `MTH 202 Absence Request for ${formattedDate}`;
    
    // Create email body with better formatting
    let emailBody = `Dear Mr. Plaku,%0D%0A%0D%0AI would like to request an absence for the following class:%0D%0A%0D%0A`;
    emailBody += `Reference ID: ${referenceID}%0D%0A`;
    emailBody += `Course: MTH 202 Mathematics for Engineers%0D%0A`;
    emailBody += `Student Name: ${name}%0D%0A`;
    emailBody += `Student ID: ${id}%0D%0A`;
    emailBody += `Date of Absence: ${formattedDate}%0D%0A`;
    emailBody += `Reason: ${reason}%0D%0A%0D%0A`;
    emailBody += `Explanation: ${explanation}%0D%0A%0D%0A`;
    emailBody += `Please let me know if you need any additional information.%0D%0A%0D%0A`;
    emailBody += `Thank you for your consideration.%0D%0A%0D%0A`;
    emailBody += `Sincerely,%0D%0A${name}`;
    
    // Open email client with CC to student
    window.location.href = `mailto:bplaku@epoka.edu.al?cc=${fullEmail}&subject=${emailSubject}&body=${emailBody}`;
    
    // Show confirmation
    document.getElementById('referenceID').textContent = referenceID;
    
    // Set appropriate confirmation message
    const confirmationMessage = document.getElementById('confirmationMessage');
    switch(reason) {
        case 'Illness':
            confirmationMessage.textContent = "I hope you feel better soon. Your absence has been recorded.";
            break;
        case 'Transport':
            confirmationMessage.textContent = "Your transportation-related absence has been recorded.";
            break;
        case 'Other':
            confirmationMessage.textContent = "Your absence has been recorded.";
            break;
    }
    
    // Show confirmation modal
    document.getElementById('confirmationModal').style.display = 'block';
    
    // Reset the form
    form.reset();
    document.getElementById('absenceDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('charCount').textContent = '0';
    document.getElementById('minChars').textContent = '50';
    document.getElementById('absenceExplanation').setAttribute('minlength', '50');
    document.getElementById('documentGroup').style.display = 'block';
    document.getElementById('docRequired').style.display = 'none';
    document.getElementById('absenceDocument').required = false;
    document.getElementById('attachmentDescription').textContent = "Accepted formats: PDF, JPG, PNG (max 5MB)";
    document.getElementById('submitBtn').disabled = true;
    
    // Hide the form
    toggleAbsenceForm();
    
    return false;
}

// Initialize everything when page loads
window.onload = function() {
    updateWeekCounter();
    updateProgress();
    updateYear();
    document.getElementById('timetable-form').submit();
    
    // Initialize date field with today's date
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('absenceDate').value = today;
    
    // Set up event listeners for absence form
    document.getElementById('studentName').addEventListener('input', function() {
        // Extract first and last name
        const nameParts = this.value.trim().split(' ');
        if (nameParts.length >= 2) {
            document.getElementById('firstName').value = nameParts[0].toLowerCase();
            document.getElementById('lastName').value = nameParts[nameParts.length - 1].toLowerCase();
        }
        
        if (this.value.trim() === '') {
            document.getElementById('nameError').style.display = 'block';
            this.classList.add('error');
        } else {
            document.getElementById('nameError').style.display = 'none';
            this.classList.remove('error');
        }
        validateForm();
    });
    
    document.getElementById('studentID').addEventListener('input', function() {
        if (!this.value.match(/^[0-9]+$/)) {
            document.getElementById('idError').style.display = 'block';
            this.classList.add('error');
        } else {
            document.getElementById('idError').style.display = 'none';
            this.classList.remove('error');
        }
        validateForm();
    });
    
    document.getElementById('emailNumber').addEventListener('input', function() {
        if (!this.value.match(/^[0-9]{2}$/)) {
            document.getElementById('emailError').style.display = 'block';
            this.classList.add('error');
        } else {
            document.getElementById('emailError').style.display = 'none';
            this.classList.remove('error');
        }
        validateForm();
    });
    
    document.getElementById('absenceDate').addEventListener('change', validateDate);
    document.getElementById('absenceReason').addEventListener('change', updateAbsenceReason);
    document.getElementById('absenceExplanation').addEventListener('input', updateCharCount);
    
    document.getElementById('absenceDocument').addEventListener('change', function() {
        if (document.getElementById('absenceReason').value === 'Illness' && !this.files.length) {
            document.getElementById('documentError').style.display = 'block';
        } else {
            document.getElementById('documentError').style.display = 'none';
        }
        validateForm();
    });
    
    document.getElementById('honorCode').addEventListener('change', function() {
        if (!this.checked) {
            document.getElementById('honorError').style.display = 'block';
        } else {
            document.getElementById('honorError').style.display = 'none';
        }
        validateForm();
    });
    
    document.getElementById('absenceForm').addEventListener('submit', function(e) {
        e.preventDefault();
        submitForm();
    });
    
    document.getElementById('close-absence-btn').addEventListener('click', toggleAbsenceForm);
    document.getElementById('cancelButton').addEventListener('click', toggleAbsenceForm);
    document.getElementById('absenceButton').addEventListener('click', toggleAbsenceForm);
    
    // Close confirmation modal
    document.querySelector('.close-confirmation').addEventListener('click', function() {
        document.getElementById('confirmationModal').style.display = 'none';
    });
    
    document.getElementById('confirmOkButton').addEventListener('click', function() {
        document.getElementById('confirmationModal').style.display = 'none';
    });
    
    // Close modal when clicking outside
    window.addEventListener('click', function(event) {
        if (event.target == document.getElementById('confirmationModal')) {
            document.getElementById('confirmationModal').style.display = 'none';
        }
    });
};
    </script>
</head>
<body>
    <div class="container">
		<div class="course-actions">
					<button style="margin-bottom: 10px;" onclick="window.open('https://teaching.bredliplaku.com/', '_self', 'noopener,noreferrer')"><i class="fas fa-chevron-left"></i> All Courses</button>
					<button style="margin-bottom: 10px;" onclick="window.open('https://eis.epoka.edu.al/', '_blank', 'noopener,noreferrer')" class="btn"><i class="far fa-user-circle"></i> EIS</button>
			</div>
        <div class="course-header">
            <h2>MTH 202</h2>
			<h1>Mathematics for Engineers</h1>
            <div class="course-info">
                <span class="info-item"><i class="fas fa-user-circle"></i> Mr. Bredli Plaku</span>
                <span class="info-item"><i class="fas fa-calendar-check"></i> Spring Semester</span>
				<span class="info-item"><i class="fas fa-graduation-cap"></i> Undergraduate</span>
				<span class="info-item"><i class="far fa-circle"></i> Elective</span>
				<span class="info-item"><i class="fas fa-trophy"></i> 5 ECTS</span>
				<span class="info-item"><i class="fas fa-calendar"></i> 16 weeks</span>
            </div>
            <span class="info-item"><i class="far fa-clock fa-spin"></i><div class="week-counter" id="week-counter"></div></span>
            
			<div class="progress-bar">
                <div class="progress"></div>
            </div>
			<div id="gradeDistributionContainer" class="grade-distribution-container">
    <div class="grade-distribution-content">
        <div class="distribution-wrapper">
			<div id="distribution-legend" class="distribution-legend"></div>
            <div id="distribution-bar" class="distribution-bar"></div>
        </div>
    </div>
</div>
        </div>
		
		<div class="course-actions">
			<button onclick="window.open('https://chat.google.com/room/AAAAv-sISaI?cls=7', '_blank', 'noopener,noreferrer')" class="btn-orange"><i class="fas fa-bullhorn"></i> Announcements</button>
			<button id="toggle-button" onclick="toggleIframe()"><i class="fas fa-calendar-alt"></i> Timetable</button>
			<button class="btn-green" id="gradeDistributionButton" onclick="toggleGradeDistribution()"><i class="fas fa-chart-pie"></i> Evaluation Criteria</button>
            <button id="absenceButton" class="btn-red"><i class="fas fa-user-clock"></i> Report Absence</button>
		</div>

        <!-- Absence form container -->
        <div class="absence-container" id="absence-container">
          <div class="absence-content">
            <div class="absence-header">
              <h2>Report Absence</h2>
              <button type="button" id="close-absence-btn" class="btn-red"><i class="fa fa-eye-slash"></i> Hide Form</button>
            </div>
            
            <div class="notice-box">
              <strong>Important:</strong> When you submit this form, a new tab will open with a pre-filled email. Please send this email to complete your absence report. Do not close the new tab without sending the email.
            </div>
            
            <form id="absenceForm">
              <div class="form-group">
                <label for="courseName">Course <span class="required">*</span></label>
                <input type="text" id="courseName" name="courseName" value="MTH 202 Mathematics for Engineers" readonly>
              </div>
              
              <div class="form-group">
                <label for="studentName">Full Name <span class="required">*</span></label>
                <input type="text" id="studentName" name="studentName" required>
                <small class="error-message" id="nameError">Full name is required</small>
              </div>
              
              <div class="form-group">
                <label for="studentID">Student ID <span class="required">*</span></label>
                <input type="text" id="studentID" name="studentID" pattern="[0-9]+" required>
                <small>Enter your numeric ID only</small>
                <small class="error-message" id="idError">Valid student ID is required</small>
              </div>
              
              <div class="form-group">
                <label for="emailNumber">EPOKA Email <span class="required">*</span></label>
                <!-- Hidden fields to store name parts -->
                <input type="hidden" id="firstName" name="firstName">
                <input type="hidden" id="lastName" name="lastName">
                
                <div class="email-field-container">
                  <span class="email-prefix">firstname+lastname+</span>
                  <input type="text" id="emailNumber" name="emailNumber" class="email-number" pattern="[0-9]{2}" maxlength="2" required>
                  <span class="email-suffix">@epoka.edu.al</span>
                </div>
                <small>Enter the 2-digit number from your EPOKA email</small>
                <small class="error-message" id="emailError">Please enter a valid 2-digit number</small>
              </div>
              
              <div class="form-group">
                <label for="absenceDate">Date of Absence <span class="required">*</span></label>
                <input type="date" id="absenceDate" name="absenceDate" required>
                <small class="error-message" id="dateError">Invalid date selected</small>
              </div>
              
              <div class="form-group">
                <label for="absenceReason">Reason for Absence <span class="required">*</span></label>
                <select id="absenceReason" name="absenceReason" required>
                  <option value="" disabled selected>Select a reason</option>
                  <option value="Illness">Illness or medical emergency</option>
                  <option value="Transport">Transportation or traffic issues</option>
                  <option value="Other">Other</option>
                </select>
                <small class="error-message" id="reasonError">Please select a reason for your absence</small>
              </div>
              
              <div class="form-group">
                <label for="absenceExplanation">Explanation <span class="required">*</span></label>
                <textarea id="absenceExplanation" name="absenceExplanation" minlength="50" rows="4" required></textarea>
                <small><span id="charCount">0</span>/<span id="minChars">50</span> characters minimum</small>
                <small class="error-message" id="explanationError">Explanation is too short</small>
              </div>
              
              <div class="form-group" id="documentGroup">
                <label for="absenceDocument">Supporting Documentation <span id="docRequired" class="required" style="display:none">*</span></label>
                <input type="file" id="absenceDocument" name="absenceDocument">
                <small id="attachmentDescription">Accepted formats: PDF, JPG, PNG (max 5MB)</small>
                <small class="error-message" id="documentError">Documentation is required for illness-related absences</small>
              </div>
              
              <div class="form-group checkbox-group">
                <input type="checkbox" id="honorCode" name="honorCode" required>
                <label for="honorCode">I certify that the information provided is accurate and complete. I understand that misrepresentation may result in disciplinary action. <span class="required">*</span></label>
                <small class="error-message" id="honorError">You must agree to the honor code</small>
              </div>
              
              <div class="disclaimer">
                Submission of this form does not guarantee approval of your absence. If you do not receive a reply to your email within 24 hours, please follow up directly with your instructor.
              </div>
              
              <div class="form-buttons">
                <button type="submit" id="submitBtn" class="btn-red" disabled>Submit</button>
                <button type="button" class="btn-blue" id="cancelButton">Cancel</button>
              </div>
            </form>
          </div>
        </div>

        <!-- Confirmation modal -->
        <div id="confirmationModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h2>Absence Report Submitted</h2>
              <span class="close-confirmation">&times;</span>
            </div>
            <div class="modal-body">
              <p>Your absence report has been prepared as an email.</p>
              <p>Reference ID: <span id="referenceID"></span></p>
              <p id="confirmationMessage"></p>
              <p><strong>Important:</strong> Please send the email that has opened in a new tab to complete your submission.</p>
              <div class="form-buttons">
                <button type="button" class="btn-red" id="confirmOkButton">OK</button>
              </div>
            </div>
          </div>
        </div>
	
	<div class="course-schedule">
        <!-- Form that will be submitted via the buttons -->
        <form id="timetable-form" action="https://eis.epoka.edu.al/publictimetable" method="POST" target="timetable-iframe">
            <input type="hidden" name="form[timetable]" value="161">
            <input type="hidden" id="class-select" name="form[programGrade]" value="26">
            <input type="hidden" name="form[_token]" value="your_csrf_token_here">
        </form>

        <!-- Iframe to load the timetable -->
<div class="iframe-container" id="iframe-container">    
    <iframe id="timetable-iframe" name="timetable-iframe"></iframe>
</div>
	<!-- </div> -->
	</div>
	
        <div class="module"> <!--Introduction-->
            <div class="module-header" onclick="toggleModule(this.parentNode)">
                <span class="module-title"><i class="far fa-smile"></i>&nbsp;&nbsp;Welcome</span>
				<span class="module-chapter"><i class="fas fa-chevron-down"></i></span>
            </div>
            <div class="module-content">
                <div class="material-item">
                    <i class="far fa-file-powerpoint material-icon"></i>
                    <div class="material-info">
                        <div class="material-title">Introduction to Linear Algebra</div>
                        <div class="material-description">PowerPoint Presentation</div>
                    </div>
                    <div class="course-actions">
						<button onclick="window.open('https://docs.google.com/presentation/d/1BfIMJ24PuknS6Vj1ZuIec56tg7kaoq3L/edit?usp=sharing', '_blank', 'noopener,noreferrer')" class="btn-blue"><i class="far fa-eye"></i> View</button>
						<button onclick="window.open('https://docs.google.com/presentation/d/1BfIMJ24PuknS6Vj1ZuIec56tg7kaoq3L/export/pptx', '_blank', 'noopener,noreferrer')" class="btn-download btn-green"><i class="far fa-save"></i> Download</button>
                    </div>
                </div>

				
                <div class="fun-fact">
                    The literature for this course is <br><b>"Anthony, M., & Harvey, M. (2012). Linear algebra: Concepts and methods. Cambridge University Press."</b>, and <br><b>"Larson, R. (2017). Elementary linear algebra (8th ed., Metric Version). Cengage Learning."</b>
                </div>
            </div>
        </div>

		<div class="module active"> <!--Module 1-->
            <div class="module-header" onclick="toggleModule(this.parentNode)">
                <span class="module-title"><i class="fas fa-folder"></i>&nbsp;&nbsp;Matrices & Vectors</span>
				<span class="module-chapter">Chapter 1&nbsp;&nbsp;<i class="fas fa-chevron-down"></i></span>
            </div>
            <div class="module-content">
                <div class="material-item">
                    <i class="far fa-file-powerpoint material-icon"></i>
                    <div class="material-info">
                        <div class="material-title">Matrices and Vectors</div>
                        <div class="material-description">PowerPoint Presentation</div>
                    </div>
                    <div class="course-actions">
						<button onclick="window.open('https://docs.google.com/presentation/d/12CkSQeSZCVjVXciwrGD9DDu50YA2v7IR/edit?usp=sharing', '_blank', 'noopener,noreferrer')" class="btn-blue"><i class="far fa-eye"></i> View</button>
						<button onclick="window.open('https://docs.google.com/presentation/d/12CkSQeSZCVjVXciwrGD9DDu50YA2v7IR/export/pptx', '_blank', 'noopener,noreferrer')" class="btn-download btn-green"><i class="far fa-save"></i> Download</button>
                    </div>
                </div>

				
                <div class="fun-fact">
                    In civil engineering, matrices allow us to solve complex structural systems with a simple equation: F = KX, where F is the force vector, K is the stiffness matrix, and X is the displacement vector. This mathematical relationship helps engineers design everything from bridges to skyscrapers.
                </div>
            </div>
        </div>

	
		<!-- <div style="position: relative; display: flex; align-items: center;"> <!-- QUIZ -->
			<!-- <div style="margin-right: 10px; position: relative; top: 50%; transform: translateY(-40%);"> -->
				<!-- <i class="fas fa-exclamation-circle" style="color: #444444; font-size: 1.4em;"></i> -->
			<!-- </div> -->
			<!-- <div class="module" style="background-color: #eeeeee; padding: 10px 15px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; display: flex; justify-content: space-between; align-items: center;"> -->
				<!-- <span class="module-title" style="color: #444444; font-weight: 600;">Quiz 2</span> -->
				<!-- <span class="module-chapter" style="color: #444444; font-size:1.0em">21 January 2025&nbsp;&nbsp;</span> -->
			<!-- </div> -->
		<!-- </div> -->
	
	</div>

	
	<footer class="footer">
        <div class="social-links">
            <a href="https://eis.epoka.edu.al/cv/fullcv/655" target="_blank" rel="noopener noreferrer"><i class="far fa-id-card"></i></a>
            <a href="mailto:bplaku@epoka.edu.al" target="_blank" rel="noopener noreferrer"><i class="far fa-envelope"></i></a>
        </div>
		<p style="font-size:0.7em"><i class="far fa-copyright"></i> 2023-<span id="currentYear"></span> Bredli Plaku. All Rights Reserved.</p>
	</footer>
</body>
</html>